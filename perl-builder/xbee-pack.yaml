schema-version: 1.0

type: builder


const:
  srcDir: /usr/src

out:
  perl: /opt/perl

provision:
  - url:
      from: https://www.cpan.org/src/5.0/perl-{% version %}.tar.xz
      todir: "{% srcDir %}"
  - url:
      from: https://www.linuxfromscratch.org/patches/lfs/11.0/perl-{% version %}-upstream_fixes-1.patch
      todir: "{% srcDir %}"
      unpack: false

build:
  - shell:
      cmds:
        - patch -Np1 -i ../perl-{% version %}-upstream_fixes-1.patch
        - sh Configure 
             -des
             -Dprefix=/usr
             -Duserelocatableinc
         - make
#        - make test
        - make install DESTDIR={% perl %}
      directory: "{% srcDir %}/perl-{% version %}"

